{
  "hash": "c6130fea3c4cb1f5580207fe800aa83a",
  "result": {
    "markdown": "---\ntitle: \"Intuition for the probability integral transform\"\ndescription: \"The probability integral transform states that, for a continuous random variable $X$, the distribution of $F_X(X)$ is $U(0, 1)$. I discuss why this makes sense.\"\nauthor: \"Carson Zhang\"\ndate: \"12/04/2023\"\ndraft: false\n---\n\n\nThe probability integral transform states that, for a continuous random variable $X$, the distribution of $F_X(X)$ is $U(0, 1)$. This result underlies inverse transform sampling. I suspect that it's also central to why p-values are normally distributed under the null hypothesis. But why does this make sense?\n\nSuppose we have a random variable $X$ from an arbitrary probability distribution.\n\nHere, $X \\sim \\text{Beta}(\\alpha = 0.9, \\beta = 3.4)$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalpha_x = 0.9\nbeta_x = 3.4\nx_seq <- seq(0, 1, length = 100)\nx_density <- dbeta(x_seq, alpha_x, beta_x)\n\nplot(x_seq, x_density, type = \"l\", lty = 1,\n     xlab = \"X\", ylab = \"Density\", main = \"Unknown density of X\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nWhat does $F_X(x)$ look like?\n\nLet's try to draw the density of $Y = F_X(x)$ one section at a time.\n\nFirst, suppose we select the top 3% of the sample. [(This comprises the values between the $0.97$ and $1$ $p$-quantiles of this distribution.)](https://en.wikipedia.org/wiki/Quantile)\n\n\n::: {.cell}\n\n:::\n\n\nHere is the density of $X$.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nFor now, since we don't know what the density of $Y = F_X(X)$ looks like, let's say it's an arbitrary curve.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nHowever, since we selected the top 3% of the probability mass, we know that, within the orange interval, the area under the curve must be $0.03$, and therefore the value of the density must be $1$ on average.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nNow, think about the region between the $0.97$ and $0.98$ $p$-quantiles of the sample. By definition, this comprises 1% of the probability mass ($0.98 - 0.97 = 0.01$), so we need to adjust our curve to satisfy this condition.\n\nHowever, we note that all intervals have this same property (even arbitrarily small intervals). It should be natural to suspect the density of curve of the CDF-transformed sample to be a horizontal line at $1$: this is the only function I can think of that guarantees this property. It feels like this can be proven more formally using real analysis.\n\n**Lemma:** For all real numbers $a, b$ such that $0 \\leq a < b \\leq 1$, $F_X(X) \\sim \\text{Uniform}(0, 1)$.\n\n**Informal mathematical argument**:\n\nLet $a, b$ be real number such that $0 \\leq a < b \\leq 1$.\n\nBy the argument above, we have $F_Y(b) - F_Y(a) = b - a$.\n\n(Note that we can rewrite this as $F(b) = b \\text{ and } F(a) = a$, i.e. $F$ is the identity.)\n\nWe have:\n\n$$\n\\begin{align}\n  F_Y(b) - F_Y(a) &= b - a\\\\\n    &= F_Y(Y) \\Big|_a^b && \\text{(standard antiderivative notation)}\\\\\n    &= \\int_a^b f_Y(y)dy && \\text{(definition of a probability density function)}\\\\\n    &= \\int_a^b 1dy && \\text{(a function with the identity as its antiderivative)}\\\\\n\\end{align}\n$$\n\nSo, we have $f_Y(y) = 1$, and therefore, $Y = F_X(x)$ has the standard uniform distribution.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}